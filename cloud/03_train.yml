$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: component_pipeline_cli_train
display_name: Train
description: Train the model
version: 1.0.0
type: command

inputs:
  epochs:
    type: integer
    default: 5
  batches_train:
    type: uri_folder
    mode: ro_mount
  batches_validation:
    type: uri_folder
    mode: ro_mount
  features_dim:
    type: uri_file
    mode: ro_mount

outputs:
  model_dir:
    type: mlflow_model
    mode: upload

environment:
  image: mcr.microsoft.com/azureml/openmpi4.1.0-ubuntu20.04:latest
  conda_file: conda.yml

code: ../src/train-src/
command: >-
  python train.py 
  --epochs ${{inputs.epochs}}
  --batches_train ${{inputs.batches_train}}
  --batches_validation ${{inputs.batches_validation}}
  --features_dim ${{inputs.features_dim}}
  --model_dir ${{outputs.model_dir}}